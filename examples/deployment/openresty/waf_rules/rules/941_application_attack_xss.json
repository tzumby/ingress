{
   "access" : [
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941011",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941012",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941100",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "XSS Attack Detected via libinjection",
         "operator" : "DETECT_XSS",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : 0,
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941110",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "4",
         "msg" : "XSS Filter - Category 1: Script Tag Vector",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)([<＜]script[^>＞]*[>＞][\\s\\S]*?)",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941120",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "4",
         "msg" : "XSS Filter - Category 2: Event Handler Vector",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)([\\s\"'`;\\/0-9\\=\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]+on[a-zA-Z]+[\\s\\x0B\\x09\\x0C\\x3B\\x2C\\x28\\x3B]*?=)",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941130",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "XSS Filter - Category 3: Attribute Vector",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)[\\s\\S](?:x(?:link:href|html|mlns)|!ENTITY.*?SYSTEM|data:text\\/html|pattern(?=.*?=)|formaction|\\@import|base64)\\b",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941140",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "XSS Filter - Category 4: Javascript URI Vector",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)(?:<(?:(?:apple|objec)t|isindex|embed|style|form|meta)\\b[^>]*?>[\\s\\S]*?|(?:=|U\\s*?R\\s*?L\\s*?\\()\\s*?[^>]*?\\s*?S\\s*?C\\s*?R\\s*?I\\s*?P\\s*?T\\s*?:)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941160",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "NoScript XSS InjectionChecker: HTML Injection",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)<[^\\w<>]*(?:[^<>\"'\\s]*:)?[^\\w<>]*(?:\\W*?s\\W*?c\\W*?r\\W*?i\\W*?p\\W*?t|\\W*?f\\W*?o\\W*?r\\W*?m|\\W*?s\\W*?t\\W*?y\\W*?l\\W*?e|\\W*?s\\W*?v\\W*?g|\\W*?m\\W*?a\\W*?r\\W*?q\\W*?u\\W*?e\\W*?e|(?:\\W*?l\\W*?i\\W*?n\\W*?k|\\W*?o\\W*?b\\W*?j\\W*?e\\W*?c\\W*?t|\\W*?e\\W*?m\\W*?b\\W*?e\\W*?d|\\W*?a\\W*?p\\W*?p\\W*?l\\W*?e\\W*?t|\\W*?p\\W*?a\\W*?r\\W*?a\\W*?m|\\W*?i?\\W*?f\\W*?r\\W*?a\\W*?m\\W*?e|\\W*?b\\W*?a\\W*?s\\W*?e|\\W*?b\\W*?o\\W*?d\\W*?y|\\W*?m\\W*?e\\W*?t\\W*?a|\\W*?i\\W*?m\\W*?a?\\W*?g\\W*?e?|\\W*?v\\W*?i\\W*?d\\W*?e\\W*?o|\\W*?a\\W*?u\\W*?d\\W*?i\\W*?o|\\W*?b\\W*?i\\W*?n\\W*?d\\W*?i\\W*?n\\W*?g\\W*?s|\\W*?s\\W*?e\\W*?t|\\W*?a\\W*?n\\W*?i\\W*?m\\W*?a\\W*?t\\W*?e)[^>\\w])|(?:<\\w[\\s\\S]*[\\s\\/]|['\"](?:[\\s\\S]*[\\s\\/])?)(?:formaction|style|background|src|lowsrc|ping|on(?:d(?:e(?:vice(?:(?:orienta|mo)tion|proximity|found|light)|livery(?:success|error)|activate)|r(?:ag(?:e(?:n(?:ter|d)|xit)|(?:gestur|leav)e|start|drop|over)?|op)|i(?:s(?:c(?:hargingtimechange|onnect(?:ing|ed))|abled)|aling)|ata(?:setc(?:omplete|hanged)|(?:availabl|chang)e|error)|urationchange|ownloading|blclick)|Moz(?:M(?:agnifyGesture(?:Update|Start)?|ouse(?:PixelScroll|Hittest))|S(?:wipeGesture(?:Update|Start|End)?|crolledAreaChanged)|(?:(?:Press)?TapGestur|BeforeResiz)e|EdgeUI(?:C(?:omplet|ancel)|Start)ed|RotateGesture(?:Update|Start)?|A(?:udioAvailable|fterPaint))|c(?:o(?:m(?:p(?:osition(?:update|start|end)|lete)|mand(?:update)?)|n(?:t(?:rolselect|extmenu)|nect(?:ing|ed))|py)|a(?:(?:llschang|ch)ed|nplay(?:through)?|rdstatechange)|h(?:(?:arging(?:time)?ch)?ange|ecking)|(?:fstate|ell)change|u(?:echange|t)|l(?:ick|ose))|m(?:o(?:z(?:pointerlock(?:change|error)|(?:orientation|time)change|fullscreen(?:change|error)|network(?:down|up)load)|use(?:(?:lea|mo)ve|o(?:ver|ut)|enter|wheel|down|up)|ve(?:start|end)?)|essage|ark)|s(?:t(?:a(?:t(?:uschanged|echange)|lled|rt)|k(?:sessione|comma)nd|op)|e(?:ek(?:complete|ing|ed)|(?:lec(?:tstar)?)?t|n(?:ding|t))|u(?:ccess|spend|bmit)|peech(?:start|end)|ound(?:start|end)|croll|how)|b(?:e(?:for(?:e(?:(?:scriptexecu|activa)te|u(?:nload|pdate)|p(?:aste|rint)|c(?:opy|ut)|editfocus)|deactivate)|gin(?:Event)?)|oun(?:dary|ce)|l(?:ocked|ur)|roadcast|usy)|a(?:n(?:imation(?:iteration|start|end)|tennastatechange)|fter(?:(?:scriptexecu|upda)te|print)|udio(?:process|start|end)|d(?:apteradded|dtrack)|ctivate|lerting|bort)|DOM(?:Node(?:Inserted(?:IntoDocument)?|Removed(?:FromDocument)?)|(?:CharacterData|Subtree)Modified|A(?:ttrModified|ctivate)|Focus(?:Out|In)|MouseScroll)|r(?:e(?:s(?:u(?:m(?:ing|e)|lt)|ize|et)|adystatechange|pea(?:tEven)?t|movetrack|trieving|ceived)|ow(?:s(?:inserted|delete)|e(?:nter|xit))|atechange)|p(?:op(?:up(?:hid(?:den|ing)|show(?:ing|n))|state)|a(?:ge(?:hide|show)|(?:st|us)e|int)|ro(?:pertychange|gress)|lay(?:ing)?)|t(?:ouch(?:(?:lea|mo)ve|en(?:ter|d)|cancel|start)|ime(?:update|out)|ransitionend|ext)|u(?:s(?:erproximity|sdreceived)|p(?:gradeneeded|dateready)|n(?:derflow|load))|f(?:o(?:rm(?:change|input)|cus(?:out|in)?)|i(?:lterchange|nish)|ailed)|l(?:o(?:ad(?:e(?:d(?:meta)?data|nd)|start)?|secapture)|evelchange|y)|g(?:amepad(?:(?:dis)?connected|button(?:down|up)|axismove)|et)|e(?:n(?:d(?:Event|ed)?|abled|ter)|rror(?:update)?|mptied|xit)|i(?:cc(?:cardlockerror|infochange)|n(?:coming|valid|put))|o(?:(?:(?:ff|n)lin|bsolet)e|verflow(?:changed)?|pen)|SVG(?:(?:Unl|L)oad|Resize|Scroll|Abort|Error|Zoom)|h(?:e(?:adphoneschange|l[dp])|ashchange|olding)|v(?:o(?:lum|ic)e|ersion)change|w(?:a(?:it|rn)ing|heel)|key(?:press|down|up)|(?:AppComman|Loa)d|no(?:update|match)|Request|zoom))[\\s\\x08]*?=",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941170",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "NoScript XSS InjectionChecker: Attribute Injection",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)(?:\\W|^)(?:javascript:(?:[\\s\\S]+[=\\\\\\(\\[\\.<]|[\\s\\S]*?(?:\\bname\\b|\\\\[ux]\\d))|data:(?:(?:[a-z]\\w+\\/\\w[\\w+-]+\\w)?[;,]|[\\s\\S]*?;[\\s\\S]*?\\b(?:base64|charset=)|[\\s\\S]*?,[\\s\\S]*?<[\\s\\S]*?\\w[\\s\\S]*?>))|@\\W*?i\\W*?m\\W*?p\\W*?o\\W*?r\\W*?t\\W*?(?:\\/\\*[\\s\\S]*?)?(?:[\"']|\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\()|\\W*?-\\W*?m\\W*?o\\W*?z\\W*?-\\W*?b\\W*?i\\W*?n\\W*?d\\W*?i\\W*?n\\W*?g[\\s\\S]*?:[\\s\\S]*?\\W*?u\\W*?r\\W*?l[\\s\\S]*?\\(",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941180",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "Node-Validator Blacklist Keywords",
         "operator" : "PM",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode",
               "lowercase"
            ]
         },
         "pattern" : [
            "document.cookie",
            "document.write",
            ".parentnode",
            ".innerhtml",
            "window.location",
            "-moz-binding",
            "<!--",
            "-->",
            "<![cdata["
         ],
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941190",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<style.*?>.*?((@[i\\\\\\\\])|(([:=]|(&#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\\\\\]|(&#x?0*((40)|(28)|(92)|(5C));?)))))",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941200",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<.*[:]?vmlframe.*?[\\s/+]*?src[\\s/+]*=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941210",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:(j|(&#x?0*((74)|(4A)|(106)|(6A));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(a|(&#x?0*((65)|(41)|(97)|(61));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(v|(&#x?0*((86)|(56)|(118)|(76));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(a|(&#x?0*((65)|(41)|(97)|(61));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(s|(&#x?0*((83)|(53)|(115)|(73));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(c|(&#x?0*((67)|(43)|(99)|(63));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(r|(&#x?0*((82)|(52)|(114)|(72));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(i|(&#x?0*((73)|(49)|(105)|(69));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(p|(&#x?0*((80)|(50)|(112)|(70));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(t|(&#x?0*((84)|(54)|(116)|(74));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(:|(&((#x?0*((58)|(3A));?)|(colon;)))).)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941220",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:(v|(&#x?0*((86)|(56)|(118)|(76));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(b|(&#x?0*((66)|(42)|(98)|(62));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(s|(&#x?0*((83)|(53)|(115)|(73));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(c|(&#x?0*((67)|(43)|(99)|(63));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(r|(&#x?0*((82)|(52)|(114)|(72));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(i|(&#x?0*((73)|(49)|(105)|(69));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(p|(&#x?0*((80)|(50)|(112)|(70));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(t|(&#x?0*((84)|(54)|(116)|(74));?))([\\t]|(&((#x?0*(9|(13)|(10)|A|D);?)|(tab;)|(newline;))))*(:|(&((#x?0*((58)|(3A));?)|(colon;)))).)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941230",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<EMBED[\\s/+].*?((src)|(type)).*?=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941240",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode",
               "lowercase"
            ]
         },
         "pattern" : "<[?]?import[\\s\\/+\\S]*?implementation[\\s\\/+]*?=",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941250",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<META[\\s/+].*?http-equiv[\\s/+]*=[\\s/+]*[\"\\'`]?(((c|(&#x?0*((67)|(43)|(99)|(63));?)))|((r|(&#x?0*((82)|(52)|(114)|(72));?)))|((s|(&#x?0*((83)|(53)|(115)|(73));?)))))",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941260",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<META[\\s/+].*?charset[\\s/+]*=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941270",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<LINK[\\s/+].*?href[\\s/+]*=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941280",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<BASE[\\s/+].*?href[\\s/+]*=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941290",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<APPLET[\\s/+>])",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941300",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i:<OBJECT[\\s/+].*?((type)|(codetype)|(classid)|(code)|(data))[\\s/+]*=)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941310",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "7",
         "msg" : "US-ASCII Malformed Encoding XSS Filter - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "lowercase",
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?:¾|¼).*(?:¾|¼|>)|(?:¾|¼|<).*(?:¾|¼)",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-tomcat",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941350",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "7",
         "msg" : "UTF-7 Encoding IE XSS - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "lowercase",
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?:\\+ADw\\-|\\+AD4\\-).*(?:\\+ADw\\-|\\+AD4\\-|>)|(?:\\+ADw\\-|\\+AD4\\-|<).*(?:\\+ADw\\-|\\+AD4\\-)",
         "rev" : "1",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-internet-explorer",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "actions" : {
            "disrupt" : "DENY"
         },
         "id" : "END_XSS_CHECKS",
         "op_negated" : 1,
         "vars" : [
            {
               "unconditional" : 1
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941013",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941014",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941101",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "XSS Attack Detected via libinjection",
         "operator" : "DETECT_XSS",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : 0,
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "Referer"
               ],
               "type" : "REQUEST_HEADERS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941150",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "1",
         "msg" : "XSS Filter - Category 5: Disallowed HTML Attributes",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode"
            ]
         },
         "pattern" : "(?i)\\b(?:s(?:tyle|rc)|href)\\b[\\s\\S]*?=",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A3",
            "OWASP_AppSensor/IE1",
            "CAPEC-242",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "specific",
                  "User-Agent"
               ],
               "type" : "REQUEST_HEADERS"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941320",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "Possible XSS Attack Detected - HTML Tag Handler",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "lowercase"
            ]
         },
         "pattern" : "<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|hr|html|i|iframe|ilayer|img|input|ins|isindex|kdb|keygen|label|layer|legend|li|limittext|link|listing|map|marquee|menu|meta|multicol|nobr|noembed|noframes|noscript|nosmartquotes|object|ol|optgroup|option|p|param|plaintext|pre|q|rt|ruby|s|samp|script|select|server|shadow|sidebar|small|spacer|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|title|tr|tt|u|ul|var|wbr|xml|xmp)\\W",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A2",
            "OWASP_AppSensor/IE1",
            "PCI/6.5.1",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ],
                  [
                     "regex",
                     "_pk_ref"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941330",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode",
               "compress_whitespace"
            ]
         },
         "pattern" : "(?i:[\"\\'][ ]*(([^a-z0-9~_:\\' ])|(in)).*?(((l|(\\\\\\\\u006C))(o|(\\\\\\\\u006F))(c|(\\\\\\\\u0063))(a|(\\\\\\\\u0061))(t|(\\\\\\\\u0074))(i|(\\\\\\\\u0069))(o|(\\\\\\\\u006F))(n|(\\\\\\\\u006E)))|((n|(\\\\\\\\u006E))(a|(\\\\\\\\u0061))(m|(\\\\\\\\u006D))(e|(\\\\\\\\u0065)))|((o|(\\\\\\\\u006F))(n|(\\\\\\\\u006E))(e|(\\\\\\\\u0065))(r|(\\\\\\\\u0072))(r|(\\\\\\\\u0072))(o|(\\\\\\\\u006F))(r|(\\\\\\\\u0072)))|((v|(\\\\\\\\u0076))(a|(\\\\\\\\u0061))(l|(\\\\\\\\u006C))(u|(\\\\\\\\u0075))(e|(\\\\\\\\u0065))(O|(\\\\\\\\u004F))(f|(\\\\\\\\u0066)))).*?=)",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A2",
            "OWASP_AppSensor/IE1",
            "PCI/6.5.1",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ],
                  [
                     "regex",
                     "_pk_ref"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "8",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "XSS_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/XSS-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "941340",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "8",
         "msg" : "IE XSS Filters - Attack Detected.",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode",
               "html_decode",
               "compress_whitespace"
            ]
         },
         "pattern" : "(?i:[\"\\'][ ]*(([^a-z0-9~_:\\' ])|(in)).+?[.].+?=)",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-xss",
            "OWASP_CRS/WEB_ATTACK/XSS",
            "WASCTC/WASC-8",
            "WASCTC/WASC-22",
            "OWASP_TOP_10/A2",
            "OWASP_AppSensor/IE1",
            "PCI/6.5.1",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "ignore" : [
                  [
                     "regex",
                     "__utm"
                  ],
                  [
                     "regex",
                     "_pk_ref"
                  ]
               ],
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "COOKIES"
            },
            {
               "parse" : [
                  "keys",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            },
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941015",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941016",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941017",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "941018",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY"
         },
         "id" : "END-REQUEST-941-APPLICATION-ATTACK-XSS",
         "op_negated" : 1,
         "vars" : [
            {
               "unconditional" : 1
            }
         ]
      }
   ],
   "body_filter" : [],
   "header_filter" : []
}

