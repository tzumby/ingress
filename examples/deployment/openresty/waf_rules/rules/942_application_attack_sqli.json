{"access":[{"actions":{"disrupt":"IGNORE"},"id":"942011","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"1","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"actions":{"disrupt":"IGNORE"},"id":"942012","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"1","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{MATCHED_VAR}"}}]},"id":"942100","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"1","msg":"SQL Injection Attack Detected via libinjection","operator":"DETECT_SQLI","opts":{"transform":["uri_decode","remove_comments"]},"pattern":0,"rev":"1","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["specific","User-Agent"],"type":"REQUEST_HEADERS"},{"parse":["specific","Referer"],"type":"REQUEST_HEADERS"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942140","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack: Common DB Names Detected","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:\\b(?:m(?:s(?:ysaccessobjects|ysaces|ysobjects|ysqueries|ysrelationships|ysaccessstorage|ysaccessxml|ysmodules|ysmodules2|db)|aster\\.\\.sysdatabases|ysql\\.db)\\b|s(?:ys(?:\\.database_name|aux)\\b|chema(?:\\W*\\(|_name\\b)|qlite(_temp)?_master\\b)|d(?:atabas|b_nam)e\\W*\\(|information_schema\\b|pg_(catalog|toast)\\b|northwind\\b|tempdb\\b))","rev":"3","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942160","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects blind sqli tests using sleep() or benchmark().","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(sleep\\((\\s*?)(\\d*?)(\\s*?)\\)|benchmark\\((.*?)\\,(.*?)\\)))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942170","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects SQL benchmark and sleep injection attempts including conditional queries","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:(select|;)\\s+(?:benchmark|if|sleep)\\s*?\\(\\s*?\\(?\\s*?\\w+))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942190","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MSSQL code execution and information gathering attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:\\s*?(?:exec|execute).*?(?:\\W)xp_cmdshell)|(?:[\"'`]\\s*?!\\s*?[\"'`\\w])|(?:from\\W+information_schema\\W)|(?:(?:(?:current_)?user|database|schema|connection_id)\\s*?\\([^\\)]*?)|(?:[\"'`];?\\s*?(?:select|union|having)\\b\\s*?[^\\s])|(?:\\wiif\\s*?\\()|(?:(?:exec|execute)\\s+master\\.)|(?:union select @)|(?:union[\\w(\\s]*?select)|(?:select.*?\\w?user\\()|(?:into[\\s+]+(?:dump|out)file\\s*?[\"'`]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942220","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Looking for integer overflow attacks, these are taken from skipfish, except 3.0.00738585072007e-308 is the \"magic number\" crash","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:^(-0000023456|4294967295|4294967296|2147483648|2147483647|0000012345|-2147483648|-2147483649|0000023456|3.0.00738585072007e-308|1e309)$))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942230","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects conditional SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:[\\s()]case\\s*?\\()|(?:\\)\\s*?like\\s*?\\()|(?:having\\s*?[^\\s]+\\s*?[^\\w\\s])|(?:if\\s?\\([\\d\\w]\\s*?[=<>~]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942240","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MySQL charset switch and MSSQL DoS attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:alter\\s*?\\w+.*?(?:character|char)\\s+set\\s+\\w+)|([\"'`];*?\\s*?waitfor\\s+(?:time|delay)\\s+[\"'`])|(?:[\"'`];.*?:\\s*?goto))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942250","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MATCH AGAINST, MERGE and EXECUTE IMMEDIATE injections","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:merge.*?using\\s*?\\()|(execute\\s*?immediate\\s*?[\"'`])|(?:match\\s*?[\\w(),+-]+\\s*?against\\s*?\\())","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942270","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Looking for basic sql injection. Common attack string for mysql, oracle and others.","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:(union(.*?)select(.*?)from)))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942280","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects Postgres pg_sleep injection, waitfor delay attacks and database shutdown attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:select\\s*?pg_sleep)|(?:waitfor\\s*?delay\\s?[\"'`]+\\s?\\d)|(?:;\\s*?shutdown\\s*?(?:;|--|#|\\/\\*|{)))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942290","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Finds basic MongoDB SQL injection attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:\\[\\$(?:ne|eq|lte?|gte?|n?in|mod|all|size|exists|type|slice|x?or|div|like|between|and)\\]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942320","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MySQL and PostgreSQL stored procedure/function injections","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:procedure\\s+analyse\\s*?\\()|(?:;\\s*?(declare|open)\\s+[\\w-]+)|(?:create\\s+(procedure|function)\\s*?\\w+\\s*?\\(\\s*?\\)\\s*?-)|(?:declare[^\\w]+[@#]\\s*?\\w+)|(exec\\s*?\\(\\s*?@))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942350","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MySQL UDF injection and other data/structure manipulation attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:create\\s+function\\s+.+\\s+returns)|(?:;\\s*?(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?[\\[(]?\\w{2,}))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942360","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects concatenated basic SQL injection and SQLLFI attempts","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:[\\d\\W]\\s+as\\s*?[\"'`\\w]+\\s*?from)|(?:^[\\W\\d]+\\s*?(?:union|select|create|rename|truncate|load|alter|delete|update|insert|desc)\\b)|(?:(?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s+(?:(?:group_)concat|char|load_file)\\s?\\(?)|(?:end\\s*?\\);)|([\"'`]\\s+regexp\\W)|(?:[\\s(]load_file\\s*?\\())","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"actions":{"disrupt":"IGNORE"},"id":"942013","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"2","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"actions":{"disrupt":"IGNORE"},"id":"942014","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"2","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942110","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack: Common Injection Testing Detected","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(^[\"'`;]+|[\"'`]+$)","rev":"4","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942120","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack: SQL Operator Detected","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(\\!\\=|\\&\\&|\\|\\||>>|<<|>=|<=|<>|<=>|\\bxor\\b|\\brlike\\b|\\bregexp\\b|\\bisnull\\b)|(?:not\\s+between\\s+0\\s+and)|(?:is\\s+null)|(like\\s+null)|(?:(?:^|\\W)in[+\\s]*\\([\\s\\d\"]+[^()]*\\))|(?:\\bxor\\b|<>|rlike(?:\\s+binary)?)|(?:regexp\\s+binary))","rev":"3","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942130","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack: SQL Tautology Detected.","operator":"REGEX","opts":{"transform":["uri_decode","replace_comments"]},"pattern":"(?i:([\\s'\"`\\(\\)]*?)([\\d\\w]++)([\\s'\"`\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\"`\\(\\)]*?)\\2|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not|not\\s+like|not\\s+regexp)([\\s'\"`\\(\\)]*?)(?!\\2)([\\d\\w]+)))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"CHAIN"},"id":"942150","maturity":"9","operator":"PM","opts":{"transform":["uri_decode","lowercase"]},"pattern":["abs","acos","adddate","addtime","aes_decrypt","aes_encrypt","ascii","asciistr","asin","atan","atan2","avg","benchmark","bin","bin_to_num","bit_and","bit_count","bit_length","bit_or","bit_xor","cast","ciel","cieling","char_length","char","character_length","charset","chr","coalesce","coercibility","collation","compress","concat_ws","concat","connection_id","conv","convert_tz","convert","cos","cot","count","dcount","cr32","curdate","current_date","current_time","current_timestamp","current_user","curtime","database","date","date_add","date_format","date_sub","datediff","day","dayname","dayofmonth","dayofweek","dayofyear","decode","default","degrees","des_decrypt","des_encrypt","dump","elt","encode","encrypt","exp","export_set","extract","extractvalue","field","field_in_set","find_in_set","floor","format","found_rows","from_base64","from_days","from_unixtime","get_format","get_lock","greatest","group_concat","hex","hextoraw","rawtohex","hour","if","ifnull","in","inet6_aton","inet6_ntoa","inet_aton","inet_ntoa","insert","instr","interval","isnull","is_free_lock","is_ipv4_compat","is_ipv4_mapped","is_ipv4","is_ipv6","is_not_null","is_not","is_null","is_used_lock","last","last_day","last_inser_id","lcase","least","left","length","ln","load_file","local","localtimestamp","locate","log","log2","log10","lower","lpad","ltrim","make_set","makedate","master_pos_wait","max","md5","microsecond","mid","min","minute","mod","month","monthname","name_const","not_in","now","nullif","oct","octet_length","old_password","ord","password","period_add","period_diff","pi","position","pow","power","procedure_analyse","quarter","quote","radians","rand","release_lock","repeat","replace","reverse","right","round","row_count","rpad","rtrim","schema","sec_to_time","second","session_user","sha","sha1","sha2","sign","sin","pg_sleep","sleep","soundex","space","sqrt","std","stddev_pop","stddev_samp","str_to_date","strcmp","subdate","substring","substring_index","substr","subtime","sum","sysdate","system_user","tan","time","timestamp","timestampadd","timestampdiff","timediff","time_format","time_to_sec","to_base64","todays","toseconds","tochar","tonchar","trim","truncate","ucase","uncompress","uncompressed_length","unhex","unix_timestamp","updatexml","upper","user","utc_date","utc_time","utc_timestamp","uuid","uuid_short","values","var_pop","var_samp","variance","version","week","weekday","weekofyear","weight_string","year","yearweek","xmltype"],"rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/2.2.6"},{"actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942150","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","msg":"SQL Injection Attack","operator":"REFIND","pattern":"(?i)\\b(?:c(?:o(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|(?:un)?t|llation|alesce)|ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|ast|r32)|s(?:u(?:b(?:str(?:ing(?:_index)?)?|(?:dat|tim)e)|m)|t(?:d(?:dev_(?:sam|po)p)?|r(?:_to_date|cmp))|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha[12]?|oundex|chema|ig?n|leep|pace|qrt)|i(?:s(?:_(?:ipv(?:4(?:_(?:compat|mapped))?|6)|n(?:ot(?:_null)?|ull)|(?:free|used)_lock)|null)|n(?:et(?:6_(?:aton|ntoa)|_(?:aton|ntoa))|s(?:ert|tr)|terval)?|f(?:null)?)|d(?:a(?:t(?:e(?:_(?:format|add|sub)|diff)?|abase)|y(?:of(?:month|week|year)|name)?)|e(?:(?:s_(?:de|en)cryp|faul)t|grees|code)|count|ump)|l(?:o(?:ca(?:l(?:timestamp)?|te)|g(?:10|2)?|ad_file|wer)|ast(?:_(?:inser_id|day))?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(?:time(?:stamp)?|date)|p(?:datexml|per)|uid(?:_short)?|case|ser)|t(?:ime(?:_(?:format|to_sec)|stamp(?:diff|add)?|diff)?|o(?:(?:second|day)s|_base64|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(?:name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|a(?:wtohex|dians|nd)|o(?:w_count|und)|ight|trim|pad)|f(?:i(?:eld(?:_in_set)?|nd_in_set)|rom_(?:unixtime|base64|days)|o(?:und_rows|rmat)|loor)|p(?:o(?:w(?:er)?|sition)|eriod_(?:diff|add)|rocedure_analyse|assword|g_sleep|i)|a(?:s(?:cii(?:str)?|in)|es_(?:de|en)crypt|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|b(?:i(?:t_(?:length|count|x?or|and)|n(?:_to_num)?)|enchmark)|e(?:x(?:tract(?:value)?|p(?:ort_set)?)|nc(?:rypt|ode)|lt)|g(?:r(?:oup_conca|eates)t|et_(?:format|lock))|v(?:a(?:r(?:_(?:sam|po)p|iance)|lues)|ersion)|o(?:(?:ld_passwo)?rd|ct(?:et_length)?)|we(?:ek(?:ofyear|day)?|ight_string)|n(?:o(?:t_in|w)|ame_const|ullif)|h(?:ex(?:toraw)?|our)|qu(?:arter|ote)|year(?:week)?|xmltype)\\W*\\(","vars":[{"type":"MATCHED_VARS"}]},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942180","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects basic SQL authentication bypass attempts 1/3","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?i:\\d[\"'`]\\s+[\"'`]\\s+\\d)|(?:^admin\\s*?[\"'`]|(\\/\\*)+[\"'`]+\\s?(?:--|#|\\/\\*|{)?)|(?:[\"'`]\\s*?(x?or|div|like|between|and)[\\w\\s-]+\\s*?[+<>=(),-]\\s*?[\\d\"'`])|(?:[\"'`]\\s*?[^\\w\\s]?=\\s*?[\"'`])|(?:[\"'`]\\W*?[+=]+\\W*?[\"'`])|(?:[\"'`]\\s*?[!=|][\\d\\s!=+-]+.*?[\"'`(].*?$)|(?:[\"'`]\\s*?[!=|][\\d\\s!=]+.*?\\d+$)|(?:[\"'`]\\s*?like\\W+[\\w\"'`(])|(?:\\sis\\s*?0\\W)|(?:where\\s[\\s\\w\\.,-]+\\s=)|(?:[\"'`][<>~]+[\"'`]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942200","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MySQL comment-/space-obfuscated injections and backtick termination","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:,.*?[)\\da-f\"'`][\"'`](?:[\"'`].*?[\"'`]|\\Z|[^\"'`]+))|(?:\\Wselect.+\\W*?from)|((?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\s*?\\(\\s*?space\\s*?\\())","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942210","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects chained SQL injection attempts 1/2","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:@.+=\\s*?\\(\\s*?select)|(?:\\d+\\s*?(x?or|div|like|between|and)\\s*?\\d+\\s*?[\\-+])|(?:\\/\\w+;?\\s+(?:having|and|x?or|div|like|between|and|select)\\W)|(?:\\d\\s+group\\s+by.+\\()|(?:(?:;|#|--)\\s*?(?:drop|alter))|(?:(?:;|#|--)\\s*?(?:update|insert)\\s*?\\w{2,})|(?:[^\\w]SET\\s*?@\\w+)|(?:(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)[\\s(]+\\w+[\\s)]*?[!=+]+[\\s\\d]*?[\"'`=()]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942260","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects basic SQL authentication bypass attempts 2/3","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select\\s+)|(?:\\w+\\s+like\\s+[\"'`])|(?:like\\s*?[\"'`]\\%)|(?:[\"'`]\\s*?like\\W*?[\"'`\\d])|(?:[\"'`]\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)\\s+[\\s\\w]+=\\s*?\\w+\\s*?having\\s+)|(?:[\"'`]\\s*?\\*\\s*?\\w+\\W+[\"'`])|(?:[\"'`]\\s*?[^?\\w\\s=.,;)(]+\\s*?[(@\"'`]*?\\s*?\\w+\\W+\\w)|(?:select\\s+?[\\[\\]()\\s\\w\\.,\"'`-]+from\\s+)|(?:find_in_set\\s*?\\())","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942300","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects MySQL comments, conditions and ch(a)r injections","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:\\)\\s*?when\\s*?\\d+\\s*?then)|(?:[\"'`]\\s*?(?:#|--|{))|(?:\\/\\*!\\s?\\d+)|(?:ch(?:a)?r\\s*?\\(\\s*?\\d)|(?:(?:(n?and|x?x?or|div|like|between|and|not)\\s+|\\|\\||\\&\\&)\\s*?\\w+\\())","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942310","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects chained SQL injection attempts 2/2","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:[\"'`]\\s+and\\s*?=\\W)|(?:\\(\\s*?select\\s*?\\w+\\s*?\\()|(?:\\*\\/from)|(?:\\+\\s*?\\d+\\s*?\\+\\s*?@)|(?:\\w[\"'`]\\s*?(?:(?:[-+=|@]+\\s+?)+|[-+=|@]+)[\\d(])|(?:coalesce\\s*?\\(|@@\\w+\\s*?[^\\w\\s])|(?:\\W!+[\"'`]\\w)|(?:[\"'`];\\s*?(?:if|while|begin))|(?:[\"'`][\\s\\d]+=\\s*?\\d)|(?:order\\s+by\\s+if\\w*?\\s*?\\()|(?:[\\s(]+case\\d*?\\W.+[tw]hen[\\s(]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942330","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects classic SQL injection probings 1/2","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:[\"'`]\\s*?(x?or|div|like|between|and)\\s*?[\"'`]?\\d)|(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\"'`]$)|(?:(?:^[\"'`\\\\\\\\]*?(?:[\\d\"'`]+|[^\"'`]+[\"'`]))+\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)\\s*?[\\w\"'`][+&!@(),.-])|(?:[^\\w\\s]\\w+\\s*?[|-]\\s*?[\"'`]\\s*?\\w)|(?:@\\w+\\s+(and|x?or|div|like|between|and)\\s*?[\"'`\\d]+)|(?:@[\\w-]+\\s(and|x?or|div|like|between|and)\\s*?[^\\w\\s])|(?:[^\\w\\s:]\\s*?\\d\\W+[^\\w\\s]\\s*?[\"'`].)|(?:\\Winformation_schema|table_name\\W))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942340","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects basic SQL authentication bypass attempts 3/3","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:in\\s*?\\(+\\s*?select)|(?:(?:n?and|x?x?or|div|like|between|and|not|\\|\\||\\&\\&)\\s+[\\s\\w+]+(?:regexp\\s*?\\(|sounds\\s+like\\s*?[\"'`]|[=\\d]+x))|([\"'`]\\s*?\\d\\s*?(?:--|#))|(?:[\"'`][\\%&<>^=]+\\d\\s*?(=|x?or|div|like|between|and))|(?:[\"'`]\\W+[\\w+-]+\\s*?=\\s*?\\d\\W+[\"'`])|(?:[\"'`]\\s*?is\\s*?\\d.+[\"'`]?\\w)|(?:[\"'`]\\|?[\\w-]{3,}[^\\w\\s.,]+[\"'`])|(?:[\"'`]\\s*?is\\s*?[\\d.]+\\s*?\\W.*?[\"'`]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942370","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects classic SQL injection probings 2/2","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:[\"'`]\\s*?\\*.+(?:x?or|div|like|between|and|id)\\W*?[\"'`]\\d)|(?:\\^[\"'`])|(?:^[\\w\\s\"'`-]+(?<=and\\s)(?<=or|xor|div|like|between|and\\s)(?<=xor\\s)(?<=nand\\s)(?<=not\\s)(?<=\\|\\|)(?<=\\&\\&)\\w+\\()|(?:[\"'`][\\s\\d]*?[^\\w\\s]+\\W*?\\d\\W*?.*?[\"'`\\d])|(?:[\"'`]\\s*?[^\\w\\s?]+\\s*?[^\\w\\s]+\\s*?[\"'`])|(?:[\"'`]\\s*?[^\\w\\s]+\\s*?[\\W\\d].*?(?:#|--))|(?:[\"'`].*?\\*\\s*?\\d)|(?:[\"'`]\\s*?(x?or|div|like|between|and)\\s[^\\d]+[\\w-]+.*?\\d)|(?:[()\\*<>%+-][\\w-]+[^\\w\\s]+[\"'`][^,]))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942380","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"\\b(?i:having)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=<>]|(?i:\\bexecute(\\s{1,5}[\\w\\.$]{1,5}\\s{0,3})?\\()|\\bhaving\\b ?(?:\\d{1,10}|[\\'\"][^=]{1,10}[\\'\"]) ?[=<>]+|(?i:\\bcreate\\s+?table.{0,20}?\\()|(?i:\\blike\\W*?char\\W*?\\()|(?i:(?:(select(.*?)case|from(.*?)limit|order\\sby)))|exists\\s(\\sselect|select\\Sif(null)?\\s\\(|select\\Stop|select\\Sconcat|system\\s\\(|\\b(?i:having)\\b\\s+(\\d{1,10})|'[^=]{1,10}')","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942390","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:\\bor\\b ?(?:\\d{1,10}|[\\'\"][^=]{1,10}[\\'\"]) ?[=<>]+|(?i:'\\s+x?or\\s+.{1,20}[+\\-!<>=])|\\b(?i:x?or)\\b\\s+(\\d{1,10}|'[^=]{1,10}')|\\b(?i:x?or)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=<>])","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942400","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i)\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=]|\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[<>]|\\band\\b ?(?:\\d{1,10}|[\\'\"][^=]{1,10}[\\'\"]) ?[=<>]+|\\b(?i:and)\\b\\s+(\\d{1,10}|'[^=]{1,10}')","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942410","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"SQL Injection Attack","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4_compat|ipv4_mapped|ipv4|ipv6|not_null|not|null|used_lock))?|n(?:et6?_(aton|ntoa)|s(?:ert|tr)|terval)?|f(null)?)|u(?:n(?:compress(?:ed_length)?|ix_timestamp|hex)|tc_(date|time|timestamp)|p(?:datexml|per)|uid(_short)?|case|ser)|l(?:o(?:ca(?:l(timestamp)?|te)|g(2|10)?|ad_file|wer)|ast(_day|_insert_id)?|e(?:(?:as|f)t|ngth)|case|trim|pad|n)|t(?:ime(stamp|stampadd|stampdiff|diff|_format|_to_sec)?|o_(base64|days|seconds|n?char)|r(?:uncate|im)|an)|m(?:a(?:ke(?:_set|date)|ster_pos_wait|x)|i(?:(?:crosecon)?d|n(?:ute)?)|o(?:nth(name)?|d)|d5)|r(?:e(?:p(?:lace|eat)|lease_lock|verse)|o(?:w_count|und)|a(?:dians|nd)|ight|trim|pad)|f(?:i(?:eld(_in_set)?|nd_in_set)|rom_(base64|days|unixtime)|o(?:und_rows|rmat)|loor)|a(?:es_(?:de|en)crypt|s(?:cii(str)?|in)|dd(?:dat|tim)e|(?:co|b)s|tan2?|vg)|p(?:o(?:sition|w(er)?)|eriod_(add|diff)|rocedure_analyse|assword|i)|b(?:i(?:t_(?:length|count|x?or|and)|n(_to_num)?)|enchmark)|e(?:x(?:p(?:ort_set)?|tract(value)?)|nc(?:rypt|ode)|lt)|v(?:a(?:r(?:_(?:sam|po)p|iance)|lues)|ersion)|g(?:r(?:oup_conca|eates)t|et_(format|lock))|o(?:(?:ld_passwo)?rd|ct(et_length)?)|we(?:ek(day|ofyear)?|ight_string)|n(?:o(?:t_in|w)|ame_const|ullif)|(rawton?)?hex(toraw)?|qu(?:arter|ote)|(pg_)?sleep|year(week)?|d?count|xmltype|hour)\\W*?\\(|\\b(?:(?:s(?:elect\\b(?:.{1,100}?\\b(?:(?:length|count|top)\\b.{1,100}?\\bfrom|from\\b.{1,100}?\\bwhere)|.*?\\b(?:d(?:ump\\b.*?\\bfrom|ata_type)|(?:to_(?:numbe|cha)|inst)r))|p_(?:sqlexec|replwritetovarbin|help|addextendedproc|is_srvrolemember|prepare|password|execute(?:sql)?|makewebtask|oacreate)|ql_(?:longvarchar|variant))|xp_(?:reg(?:re(?:movemultistring|ad)|delete(?:value|key)|enum(?:value|key)s|addmultistring|write)|terminate|servicecontrol|ntsec_enumdomains|terminate_process|e(?:xecresultset|numdsn)|availablemedia|loginconfig|cmdshell|filelist|dirtree|makecab|ntsec)|u(?:nion\\b.{1,100}?\\bselect|tl_(?:file|http))|d(?:b(?:a_users|ms_java)|elete\\b\\W*?\\bfrom)|group\\b.*?\\bby\\b.{1,100}?\\bhaving|open(?:rowset|owa_util|query)|load\\b\\W*?\\bdata\\b.*?\\binfile|(?:n?varcha|tbcreato)r|autonomous_transaction)\\b|i(?:n(?:to\\b\\W*?\\b(?:dump|out)file|sert\\b\\W*?\\binto|ner\\b\\W*?\\bjoin)\\b|(?:f(?:\\b\\W*?\\(\\W*?\\bbenchmark|null\\b)|snull\\b)\\W*?\\()|print\\b\\W*?\\@\\@|cast\\b\\W*?\\()|c(?:(?:ur(?:rent_(?:time(?:stamp)?|date|user)|(?:dat|tim)e)|h(?:ar(?:(?:acter)?_length|set)?|r)|iel(?:ing)?|ast|r32)\\W*?\\(|o(?:(?:n(?:v(?:ert(?:_tz)?)?|cat(?:_ws)?|nection_id)|(?:mpres)?s|ercibility|alesce|t)\\W*?\\(|llation\\W*?\\(a))|d(?:(?:a(?:t(?:e(?:(_(add|format|sub))?|diff)|abase)|y(name|ofmonth|ofweek|ofyear)?)|e(?:(?:s_(de|en)cryp|faul)t|grees|code)|ump)\\W*?\\(|bms_\\w+\\.\\b)|(?:;\\W*?\\b(?:shutdown|drop)|\\@\\@version)\\b|\\butl_inaddr\\b|\\bsys_context\\b|'(?:s(?:qloledb|a)|msdasql|dbo)'))","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942430","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (12)","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"((?:[\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>][^\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>]*?){12})","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942440","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"8","msg":"SQL Comment Sequence Detected.","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(/\\*!?|\\*/|[';]--|--[\\s\\r\\n\\v\\f]|(?:--[^-]*?-)|([^\\-&])#.*?[\\s\\r\\n\\v\\f]|;?\\\\x00)","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQL_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942450","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"8","msg":"SQL Hex Encoding Identified","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i:(?:\\A|[^\\d])0x[a-f\\d]{3,}[a-f\\d]*)+","rev":"2","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/2"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"actions":{"disrupt":"IGNORE"},"id":"942015","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"3","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"actions":{"disrupt":"IGNORE"},"id":"942016","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"3","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"accuracy":"6","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.CRITICAL_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/SQLI-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942251","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Detects HAVING injections","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"(?i)\\W+\\d*?\\s*?having\\s*?[^\\s\\-]","rev":"1","severity":"CRITICAL","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/3"],"vars":[{"ignore":[["regex","__utm"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942420","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (8)","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"((?:[\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>][^\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>]*?){8})","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/3"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"],["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942431","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (6)","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"((?:[\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>][^\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>]*?){6})","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/3"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942460","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Meta-Character Anomaly Detection Alert - Repetitive Non-Word Characters","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"\\W{4}","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/3"],"vars":[{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"actions":{"disrupt":"IGNORE"},"id":"942017","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"4","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"actions":{"disrupt":"IGNORE"},"id":"942018","operator":"LESS","opts":{"nolog":1,"parsepattern":1},"pattern":"4","skip_after":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","vars":[{"parse":["specific","PARANOIA_LEVEL"],"storage":1,"type":"TX"}]},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942421","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Restricted SQL Character Anomaly Detection (cookies): # of special characters exceeded (3)","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"((?:[\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>][^\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>]*?){3})","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/4"],"vars":[{"ignore":[["regex","__utm"],["regex","_pk_ref"],["regex","__utm"],["regex","_pk_ref"]],"parse":["values","1"],"type":"COOKIES"},{"parse":["keys","1"],"type":"COOKIES"}],"ver":"OWASP_CRS/3.0.0"},{"accuracy":"8","actions":{"disrupt":"DENY","nondisrupt":[{"action":"setvar","data":{"col":"TX","inc":1,"key":"ANOMALY_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","inc":1,"key":"SQL_INJECTION_SCORE","value":"%{TX.WARNING_ANOMALY_SCORE}"}},{"action":"setvar","data":{"col":"TX","key":"MSG","value":"%{rule.msg}"}},{"action":"setvar","data":{"col":"TX","key":"%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{MATCHED_VAR_NAME}","value":"%{TX.0}"}}]},"id":"942432","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","maturity":"9","msg":"Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)","operator":"REGEX","opts":{"transform":["uri_decode"]},"pattern":"((?:[\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>][^\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\´\\’\\‘\\`\\<\\>]*?){2})","rev":"2","severity":"WARNING","tag":["application-multi","language-multi","platform-multi","attack-sqli","OWASP_CRS/WEB_ATTACK/SQL_INJECTION","WASCTC/WASC-19","OWASP_TOP_10/A1","OWASP_AppSensor/CIE1","PCI/6.5.2","paranoia-level/4"],"vars":[{"parse":["keys","1"],"type":"REQUEST_ARGS"},{"parse":["values","1"],"type":"REQUEST_ARGS"}],"ver":"OWASP_CRS/3.0.0"},{"actions":{"disrupt":"DENY"},"id":"END-REQUEST-942-APPLICATION-ATTACK-SQLI","op_negated":1,"vars":[{"unconditional":1}]}],"body_filter":[],"header_filter":[]}
