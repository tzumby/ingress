{
   "access" : [
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931011",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931012",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "1",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RFI_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RFI-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "931100",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "9",
         "msg" : "Possible Remote File Inclusion (RFI) Attack: URL Parameter using IP Address",
         "operator" : "REGEX",
         "pattern" : "^(?i)(?:file|ftps?|https?):\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rfi",
            "OWASP_CRS/WEB_ATTACK/RFI"
         ],
         "vars" : [
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RFI_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RFI-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "931110",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "9",
         "msg" : "Possible Remote File Inclusion (RFI) Attack: Common RFI Vulnerable Parameter Name used w/URL Payload",
         "operator" : "REGEX",
         "opts" : {
            "transform" : [
               "uri_decode"
            ]
         },
         "pattern" : "(?i:(\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(file|ftps?|https?):\\/\\/)",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rfi",
            "OWASP_CRS/WEB_ATTACK/RFI"
         ],
         "vars" : [
            {
               "type" : "QUERY_STRING"
            },
            {
               "type" : "REQUEST_BODY"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RFI_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RFI-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.0}"
                  }
               }
            ]
         },
         "id" : "931120",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "maturity" : "9",
         "msg" : "Possible Remote File Inclusion (RFI) Attack: URL Payload Used w/Trailing Question Mark Character (?)",
         "operator" : "REGEX",
         "pattern" : "^(?i)(?:file|ftps?|https?)(.*?)\\?+$",
         "rev" : "2",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rfi",
            "OWASP_CRS/WEB_ATTACK/RFI"
         ],
         "vars" : [
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931013",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931014",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "2",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "accuracy" : "9",
         "actions" : {
            "disrupt" : "CHAIN"
         },
         "id" : "931130",
         "maturity" : "9",
         "operator" : "REGEX",
         "pattern" : "^(?i)(?:file|ftps?|https?)://(.*)$",
         "rev" : "3",
         "severity" : "CRITICAL",
         "tag" : [
            "application-multi",
            "language-multi",
            "platform-multi",
            "attack-rfi",
            "OWASP_CRS/WEB_ATTACK/RFI",
            "paranoia-level/2"
         ],
         "vars" : [
            {
               "parse" : [
                  "values",
                  "1"
               ],
               "type" : "REQUEST_ARGS"
            }
         ],
         "ver" : "OWASP_CRS/3.0.0"
      },
      {
         "actions" : {
            "disrupt" : "DENY",
            "nondisrupt" : [
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "MSG",
                     "value" : "%{rule.msg}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "RFI_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "inc" : 1,
                     "key" : "ANOMALY_SCORE",
                     "value" : "%{TX.CRITICAL_ANOMALY_SCORE}"
                  }
               },
               {
                  "action" : "setvar",
                  "data" : {
                     "col" : "TX",
                     "key" : "%{RULE.ID}-OWASP_CRS/WEB_ATTACK/RFI-%{MATCHED_VAR_NAME}",
                     "value" : "%{TX.1}"
                  }
               }
            ]
         },
         "id" : "931130",
         "logdata" : "Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}",
         "msg" : "Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link",
         "op_negated" : 1,
         "operator" : "REFIND",
         "opts" : {
            "parsepattern" : 1
         },
         "pattern" : "^%{REQUEST_HEADERS.host}",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "1"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931015",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931016",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "3",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931017",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "IGNORE"
         },
         "id" : "931018",
         "operator" : "LESS",
         "opts" : {
            "nolog" : 1,
            "parsepattern" : 1
         },
         "pattern" : "4",
         "skip_after" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "vars" : [
            {
               "parse" : [
                  "specific",
                  "PARANOIA_LEVEL"
               ],
               "storage" : 1,
               "type" : "TX"
            }
         ]
      },
      {
         "actions" : {
            "disrupt" : "DENY"
         },
         "id" : "END-REQUEST-931-APPLICATION-ATTACK-RFI",
         "op_negated" : 1,
         "vars" : [
            {
               "unconditional" : 1
            }
         ]
      }
   ],
   "body_filter" : [],
   "header_filter" : []
}

